{% extends "index.html" %}

{% block content %}

<div class="container mt-5">
  <h2>Lista książek</h2>
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>Nr</th>
        <th>Tytuł</th>
        <th>Autor</th>
        <th>Rok wydania</th>
        <th>Gatunek</th>
        <th>Opis</th>
        <th>Status</th>
        <th>Akcje</th>
      </tr>
    </thead>
    <tbody>
      {% for book in books %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ book.title }}</td>
        <td>
            {% for author in book.authors %}
            {{ author.name }} {{ author.surname }}{% if not loop.last %}, {% endif %}
            {% endfor %}
        </td>
        <td>{{ book.year_published }}</td>
        <td>{{ book.genre }}</td>
        <td>{{ book.description }}</td>
        <td>
          {% if book.status == "Wypożyczona" %}
            <span class="badge bg-warning text-dark">{{ book.status }}</span>
          {% else %}
            <span class="badge bg-success">{{ book.status }}</span>
          {% endif %}
        </td>
        <td>
          <div class="dropdown">
            <button class="btn btn-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            </button>
            <ul class="dropdown-menu">
              <li>
                <a class="dropdown-item" href="{{ url_for('status_update', book_id=book.id) }}">{% if book.status == "Wypożyczona" %}Zwróć{% else %}Wypożycz{% endif %}</a>
              </li>
              <li>
                <a class="dropdown-item" href="{{ url_for('edit', book_id=book.id) }}">Edytuj</a>
              </li>
              <li>
                <a class="dropdown-item text-danger" href="{{ url_for('delete', book_id=book.id) }}">Usuń</a>
              </li>
            </ul>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="container mt-5">
  <h2>Lista wypożyczeń</h2>
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>Nr</th>
        <th>Książka</th>
        <th>Data wypożyczenia</th>
        <th>Data zwrotu</th>
      </tr>
    </thead>
    <tbody>
      {% for rental in rentals %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ rental.book.title }}</td>
        <td>{{ rental.rental_date }}</td>
        <td>{{ rental.return_date if rental.return_date else "-" }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}